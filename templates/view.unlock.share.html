{{ template "layout.header.html" . }}



<div id="future">
    <br>
    <br>
    {{ .Id }}
    <br>
    <br>
    {{ .Password }}
    <br>
    <br>



    <form id="form">
        <label for="sharePassword">Password</label>
        <input id="sharePassword" type="password" />

        <input type="submit" value="unlock">

        <div id="error"></div>

    </form>



    <script>
        // This permit to send data to /share/unlock without reloading the HTML.
        // The URL is configured in Go side to return the password
        form.onsubmit = async (e) => {
            e.preventDefault();

            let response = await fetch('/share/unlock', {
                method: 'POST',
                body: new FormData(form)
            });

            let result = await response.json();


            let future = document.getElementById('form')                                // Element that will be replaced with the content of the share
            let error = document.getElementById('error')                                // Element to display error like wrong passwords
            let givenPassword = document.getElementById('sharePassword').value          // Password given by the user

            // If the given password correspond to the password of the share
            if (givenPassword === result.message) {
                let data = document.createElement('div')
                data.innerHTML = 'content of the secret';
                future.replaceWith(data)

                // Of display error in case of wrong password
            } else {
                let data = document.createElement('div')
                data.setAttribute("id", "error");                                   // Set the ID to always replace the same element with the error

                data.innerHTML = 'wrong password';
                error.replaceWith(data);

            }
        };
    </script>

</div>



{{ template "layout.footer.html" . }}